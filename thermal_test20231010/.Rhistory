library(readxl)
library(dplyr)
library(lubridate)
library(exifr)
library(lmtest)
library(Metrics)
setwd("D:\\thermal_test20231010")
cooler_temps_logger <- read_xlsx(path = "cooler_temps20231010.xlsx", skip = 1, sheet = 'Data')
cooler_temps_logger$Time <- as.POSIXlt(cooler_temps_logger$Time)
cooler_temps_logger <- cooler_temps_logger %>% filter(Time >= ymd_hms('2023-10-10 13:35:00')) %>% filter(Time <= ymd_hms('2023-10-10 16:00:00'))
plot(cooler_temps_logger$Time, cooler_temps_logger$Temperature)
cooler_temps_logger$id = seq(0:1740)
camera_temps <- read.csv('temps.csv')
camera_temps$id <- seq(0:1740)
merged_df <- merge(cooler_temps_logger, camera_temps, by = 'id')
plot(merged_df$temp_c, merged_df$Temperature)
plot(merged_df$Time, merged_df$temp_c - merged_df$Temperature)
summary(lm(Temperature~temp_c, data = merged_df))
merged_df$diff = merged_df$temp_c - merged_df$Temperature
summary(lm(diff~id, data = merged_df))
sd(merged_df$Temperature)
sd(merged_df$temp_c)
summary(lm(Temperature~temp_c:id + temp_c, data = merged_df))
plot(((merged_df$temp_c - mean(merged_df$temp_c))/sd(merged_df$temp_c)), ((merged_df$Temperature-mean(merged_df$Temperature))/sd(merged_df$Temperature)))
# is bias change just showsing us cam warming up
# plot diff vs exif camera temp internal
merged_df$sec <- seconds(merged_df$Time)
merged_df$sec <- merged_df$sec-min(merged_df$sec)
# get the exif things
camera_exif <- read_exif("D:\\thermal_test20231010\\photos_20231010", recursive = TRUE)
camera_exif$id = seq(0:1740)
exif_sub <- camera_exif %>% select(id, SceneTemperature, ImagerTemperatureC)
merged_df <- merge(merged_df, exif_sub, by = 'id')
# durbin watson test diffs against time
mdl.test <- lm(diff~sec, data= merged_df)
summary(mdl.test)
mdl.test2 <- lm(diff~ImagerTemperatureC, data = merged_df)
summary(mdl.test2)
mdl.test3 <- lm(diff~SceneTemperature, data = merged_df)
summary(mdl.test3)
plot(merged_df$sec, merged_df$diff)
dwtest(mdl.test)
library(nlme)
mdl.ac <- gls(Temperature ~temp_c, data=merged_df,
correlation = corAR1(form=~sec),
na.action=na.omit)
summary(mdl.ac)
mdl.ac2 <- gls(Temperature ~temp_c+ temp_c:sec, data=merged_df,
correlation = corAR1(form=~sec),
na.action=na.omit)
summary(mdl.ac2)
mdl.ac3 <- gls(Temperature ~temp_c+ ImagerTemperatureC, data=merged_df,
correlation = corAR1(form=~sec),
na.action=na.omit)
summary(mdl.ac3)
noAR2 <- lm(Temperature~temp_c + ImagerTemperatureC + temp_c:ImagerTemperatureC+temp_c:sec, data = merged_df)
summary(noAR2)
summary(lm(Temperature~temp_c + sec, data = merged_df))
max(merged_df$sec)
8700* (-.0000152)
plot(merged_df$diff, merged_df$sec)
plot(merged_df$sec, merged_df$diff)
summary(lm(Temperature~temp_c + ImagerTemperatureC + sec, data = merged_df))
max(merged_df$ImagerTempreatureC)
View(merged_df)
.000165*8000
.00165*8700
summary(lm(Temperature~temp_c, data = merged_df))
mdl.ac <- gls(Temperature ~temp_c, data=merged_df,
correlation = corAR1(form=~sec),
na.action=na.omit)
summary(mdl.ac)
summary(lm(Temperature~sec, data = merged_df))
summary(lm(Temperature~ImagerTemperatureC, data = merged_df))
base_mod <- lm(Temperature~temp_c, data = merged_df)
plot(base_mod$residuals)
plot(base_mod)
View(camera_exif)
plot(merged_df$sec, merged_df$diff)
plot(merged_df$temp_c, merged_df$Temperature)
abline(-90.74336, 2.78534)
abline(2.9168407, 0.928)
master <- read_excel("C:\\Users\\deadf\\imageprocessing\\data\\cooler_tests_master.xlsx")
# break out individual treatments
sun_temps <- master %>% filter(treatment == "sun")
shade_temps <- master %>% filter(treatment == "shade")
fan_temps <- master %>% filter(treatment == "fan")
predict(base_mod, newdata = sun_temps$C)
names(sun_temps)
sun_temps_new <- sun_temps %>%
select(C, NIST_temp_C) %>% rename(temp_c = C, Temperature = NIST_temp_C)
predict(base_mod, newdata = sun_temps_new)
plot(predict(base_mod, newdata = sun_temps_new), sun_temps_new$Temperature)
rmse(predict(base_mod, newdata = sun_temps_new), sun_temps_new$Temperature)
rmse(sun_temps_new$temp_c, sun_temps_new$Temperature)
rmse(predict(base_mod), merged_df$Temperature)
fan_temps_new <- fan_temps %>%
select(C, NIST_temp_C) %>% rename(temp_c = C, Temperature = NIST_temp_C)
rmse(predict(base_mod, newdata = fan_temps_new), fan_temps_new$Temperature)
shade_temps_new <- shade_temps %>%
select(C, NIST_temp_C) %>% rename(temp_c = C, Temperature = NIST_temp_C)
rmse(predict(base_mod, newdata = shade_temps_new), shade_temps_new$Temperature)
rmse(fan_temps_new$temp_c, fan_temps_new$Temperature)
rmse(shade_temps_new$temp_c, shade_temps_new$Temperature)
rmse(merged_df$temp_c, merged_df$Temperature)
?rmse
rmse(merged_df$Temperature, merged_df$temp_c)
